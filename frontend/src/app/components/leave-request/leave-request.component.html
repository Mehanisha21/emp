<ng-template #loadingOrError>
  <div class="leave-details-card" style="text-align: center">
    <div *ngIf="errorMessage; else loading" class="error-message">
      {{ errorMessage }}
    </div>
    <ng-template #loading>
      <div class="loading-leave">Loading leave data...</div>
    </ng-template>
  </div>
</ng-template>

<!-- Main Content Display -->
<div class="leave-data-wrapper" *ngIf="!errorMessage && leaves.length > 0; else loadingOrError">
  <div class="leave-details-card">
    <div class="leave-header-row">
      <span class="leave-title">Employee Leave Details</span>
    </div>

    <div class="leave-searchbar">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        class="leave-search-input"
        placeholder="Search leave type" />
      <svg class="search-icon" viewBox="0 0 20 20">
        <circle cx="9" cy="9" r="7" stroke="#2563eb" stroke-width="2" fill="none"/>
        <path d="M13.5 13.5L18 18" stroke="#2563eb" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </div>

    <div class="table-container">
      <table class="leave-table">
        <thead>
          <tr>
            <th>Personnel #</th>
            <th>Leave Type</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Days</th>
            <th>Balance</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of filteredLeaves()">
              <td>{{row.Pernr}}</td>
              <td>{{row.Awart}}</td>
              <td>{{row.Begda}}</td>
              <td>{{row.Endda}}</td>
              <td>{{row.Abwtg}}</td>
              <td>
                <span [ngClass]="{'balance-neg': +row.Balance < 0, 'balance-pos': +row.Balance >= 0}">
                  {{row.Balance}}
                </span>
              </td>
              <td>{{row.Atext}}</td>
            </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
